<main>
  <h2>Gestor de Productos</h2>
  <form [formGroup]="productosForm" (ngSubmit)="onSubmit()">
    <label>Nombre del Producto:</label>
    <br>
    <input type="text" formControlName="nombre"/>
    <section *ngIf="productosForm.get('nombre')?.touched && productosForm.get('nombre')?.invalid" style="color:red;">
      <article *ngIf="productosForm.get('nombre')?.errors?.['required']">Requerido</article>
      <article *ngIf="productosForm.get('nombre')?.errors?.['minlength']">Mínimo 3 caracteres</article>
    </section>
    <br>
    <label>Descripción:</label>
    <br>
    <textarea formControlName="descripcion"></textarea>
    <section *ngIf="productosForm.get('descripcion')?.touched && productosForm.get('descripcion')?.invalid" style="color:red;">
      <article *ngIf="productosForm.get('descripcion')?.errors?.['required']">Requerido</article>
      <article *ngIf="productosForm.get('descripcion')?.errors?.['maxlength']">Máximo 200 caracteres</article>
    </section>
    <br>
    <label>Precio (€):</label>
    <br>
    <input type="number" step="0.01" formControlName="precio" />
    <section *ngIf="productosForm.get('precio')?.touched && productosForm.get('precio')?.invalid" style="color:red;">
      <article *ngIf="productosForm.get('precio')?.errors?.['required']">Requerido</article>
      <article *ngIf="productosForm.get('precio')?.errors?.['min']">Debe ser mayor a 0</article>
    </section>
    <br>
    <label>Cantidad:</label>
    <br>
    <input type="number" formControlName="cantidad" />
    <section *ngIf="productosForm.get('cantidad')?.touched && productosForm.get('cantidad')?.invalid" style="color:red;">
      <article *ngIf="productosForm.get('cantidad')?.errors?.['required']">Requerido</article>
      <article *ngIf="productosForm.get('cantidad')?.errors?.['min']">Mínimo 1</article>
      <article *ngIf="productosForm.get('cantidad')?.errors?.['max']">Máximo permitido: 1000</article>
    </section>
    <br>
    <label>Categoría:</label>
    <br>
    <input type="text" formControlName="categoria" />
    <section *ngIf="productosForm.get('categoria')?.touched && productosForm.get('categoria')?.invalid" style="color:red;">
      <article *ngIf="productosForm.get('categoria')?.errors?.['required']">Requerido</article>
    </section>
    <br>
    <button type="submit" [disabled]="productosForm.invalid">Agregar Producto</button>
  </form>
  <hr>
  <h3>Productos Ingresados</h3>
  <table border="1" cellpadding="5">
    <thead>
    <tr>
      <th>ID</th>
      <th>Nombre</th>
      <th>Descripción</th>
      <th>Precio (€)</th>
      <th>Cantidad</th>
      <th>Acciones</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let p of productos">
      <td>{{ p.id }}</td>
      <td>{{ p.nombre }}</td>
      <td>{{ p.descripcion }}</td>
      <td>{{ p.precio | currency:'EUR':'symbol':'1.2-2' }}</td>
      <td>{{ p.cantidad }}</td>
      <td>
        <button (click)="eliminarProducto(p.id)">Eliminar</button>
      </td>
    </tr>
    </tbody>
  </table>
  <h3>
    Total del Inventario:
    {{ calcularTotal() | currency:'EUR':'symbol':'1.2-2' }}
  </h3>
</main>
